<div
  class="min-h-screen bg-[var(--bg-dark)] text-[var(--text-secondary)] font-sans selection:bg-sky-400 selection:text-[var(--bg-dark)] overflow-x-hidden bg-grid">
  <header class="relative pt-32 pb-12 border-b border-[var(--border-light)]">
    <div class="container mx-auto px-6 relative z-10">
      <div class="flex flex-col items-start reveal-on-scroll">
        <div class="inline-block px-3 py-1 font-bold border border-sky-500/30 text-sky-400 text-sm mb-6 bg-sky-500/5">
          CATÁLOGO EXCLUSIVO — VENEZUELA
        </div>
        <h1
          class="text-4xl lg:text-6xl font-bold text-[var(--text-heading)] uppercase tracking-tight leading-none mb-6">
          Propiedades <br />
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-blue-600">
            Selectas
          </span>
        </h1>
        <p class="text-lg text-[var(--text-secondary)] max-w-xl border-l-2 border-sky-500 pl-6">
          Explore nuestra colección curada de bienes raíces en las ubicaciones
          más codiciadas.
        </p>
      </div>
    </div>
  </header>

  <div class="sticky top-0 z-40 bg-[var(--bg-dark)]/80 backdrop-blur-md border-b border-[var(--border-light)]">
    <div class="container mx-auto px-6 py-6">
      <div class="reveal-on-scroll">
        <shared-search-bar (search)="onSearch($event)" [dropdownOptions]="propertyTypeOptions"
          placeholder="BUSCAR POR ZONA..." label="UBICACIÓN" dropdownLabel="TIPO DE INMUEBLE" buttonText="BUSCAR"
          [showAdvancedFilters]="true" [statusOptions]="statusOptions" [sortOptions]="sortOptions">
        </shared-search-bar>
      </div>
    </div>
  </div>

  <section class="py-16 min-h-[50vh] relative">
    <!-- Seamless Loading Bar -->
    @if (loading && !isInitialLoad) {
    <div class="absolute top-0 left-0 w-full h-0.5 bg-transparent overflow-hidden z-20">
      <div class="w-full h-full bg-sky-500 animate-[loading-bar_1.5s_infinite_linear] origin-left"></div>
    </div>
    }

    <div class="container mx-auto px-6 transition-opacity duration-300" [class.opacity-40]="loading && !isInitialLoad"
      [class.pointer-events-none]="loading && !isInitialLoad">
      @if (properties.length > 0) {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        @for (property of properties; track property._id) {
        <div class="reveal-on-scroll group relative">
          <div
            class="absolute -top-2 -left-2 w-8 h-8 border-l border-t border-sky-500/0 group-hover:border-sky-500 transition-colors duration-300">
          </div>
          <div
            class="absolute -bottom-2 -right-2 w-8 h-8 border-r border-b border-sky-500/0 group-hover:border-sky-500 transition-colors duration-300">
          </div>

          <shared-property-card [property]="property"></shared-property-card>
        </div>
        }
      </div>
      } @else if (!loading || isInitialLoad) {
      <div
        class="flex flex-col items-center justify-center py-24 border border-dashed border-[var(--border-light)] bg-[var(--bg-panel)] reveal-on-scroll">
        @if (loading && isInitialLoad) {
        <div class="flex flex-col items-center animate-pulse">
          <i class="pi pi-spin pi-cog text-sky-500 text-4xl mb-4"></i>
          <span class="text-sm text-sky-500 uppercase tracking-widest">Buscando Datos...</span>
        </div>
        } @else {
        <div class="h-16 w-16 mb-6 text-[var(--text-secondary)]">
          <i class="pi pi-search text-4xl"></i>
        </div>
        <h3 class="text-xl font-bold text-[var(--text-heading)] uppercase tracking-widest mb-2">
          Sin Resultados
        </h3>
        <p class="text-base text-[var(--text-secondary)] max-w-md text-center mb-8">
          No hemos encontrado propiedades que coincidan con sus criterios
          actuales.
        </p>
        <button (click)="resetFilters()"
          class="px-8 py-3 bg-sky-500 hover:bg-sky-400 text-white text-sm font-bold uppercase tracking-wider transition-colors">
          Limpiar Filtros
        </button>
        }
      </div>
      }
    </div>
  </section>

  @if (properties.length > 0) {
  <footer class="border-t border-[var(--border-light)] bg-[var(--bg-dark)] py-8">
    <div class="container mx-auto px-6 flex flex-col sm:flex-row items-center justify-between gap-4">
      <div class="text-sm text-[var(--text-secondary)] uppercase tracking-wider">
        Mostrando página
        <span class="text-[var(--text-heading)] font-bold">{{ currentPage }}</span> de
        {{ totalPages }}
      </div>

      <div class="flex items-center gap-2">
        <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1"
          class="h-10 px-6 border border-[var(--border-light)] text-sm font-bold uppercase tracking-widest text-[var(--text-secondary)] hover:bg-white/5 hover:text-[var(--text-heading)] hover:border-sky-500/50 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:border-[var(--border-light)] disabled:hover:bg-transparent transition-all">
          Anterior
        </button>

        <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages"
          class="h-10 px-6 border border-[var(--border-light)] text-sm font-bold uppercase tracking-widest text-[var(--text-secondary)] hover:bg-white/5 hover:text-[var(--text-heading)] hover:border-sky-500/50 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:border-[var(--border-light)] disabled:hover:bg-transparent transition-all">
          Siguiente
        </button>
      </div>
    </div>
  </footer>
  }
</div>