<div class="flex flex-col min-h-[calc(100vh-4rem)] justify-center px-4 py-12 sm:px-6 lg:px-8">
  <div class="max-w-md w-full space-y-8 mx-auto">
    <div class="text-center">
      <i class="pi pi-key text-6xl text-sky-600"></i>
      <h2 class="mt-6 text-3xl font-bold text-gray-900">
        Crea tu nueva contraseña
      </h2>
      @if (email) {
        <p class="mt-2 text-lg text-gray-600">
          Ingresa tu nueva contraseña para la cuenta:<br>
          <span class="font-medium text-gray-900">{{ email }}</span>
        </p>
      } @else {
         <p class="mt-2 text-lg text-gray-600">
          Ingresa tu nueva contraseña.
        </p>
      }
    </div>

    <form class="mt-8 space-y-6" [formGroup]="setPasswordForm" (ngSubmit)="onSubmit()">
      <div>
        <label for="newPassword" class="block text-sm font-medium text-gray-700">Nueva Contraseña</label>
        <input
          id="newPassword"
          type="password"
          formControlName="newPassword"
          autocomplete="new-password"
          class="mt-1 appearance-none relative block w-full px-3 py-2 border rounded-md"
          [class.border-red-300]="newPassword?.invalid && newPassword?.touched"
          [class.border-gray-300]="!newPassword?.invalid || !newPassword?.touched"
        />
        @if (newPassword?.invalid && newPassword?.touched) {
          <div class="mt-1 text-sm text-red-600">
            @if (newPassword?.errors?.['required']) { <span>La contraseña es requerida.</span> }
            @if (newPassword?.errors?.['minlength']) { <span>Debe tener al menos 8 caracteres.</span> }
          </div>
        }
      </div>

      <div>
        <label for="confirmPassword" class="block text-sm font-medium text-gray-700">Confirmar Contraseña</label>
        <input
          id="confirmPassword"
          type="password"
          formControlName="confirmPassword"
          autocomplete="new-password"
          class="mt-1 appearance-none relative block w-full px-3 py-2 border rounded-md"
          [class.border-red-300]="(confirmPassword?.invalid || setPasswordForm.hasError('mismatch')) && confirmPassword?.touched"
          [class.border-gray-300]="!confirmPassword?.invalid && !setPasswordForm.hasError('mismatch') || !confirmPassword?.touched"
        />
        @if ((confirmPassword?.invalid || setPasswordForm.hasError('mismatch')) && confirmPassword?.touched) {
          <div class="mt-1 text-sm text-red-600">
            @if (confirmPassword?.errors?.['required']) { <span>Confirma tu contraseña.</span> }
            @if (setPasswordForm.hasError('mismatch')) { <span>Las contraseñas no coinciden.</span> }
          </div>
        }
      </div>

      <div>
        <button
          type="submit"
          [disabled]="loading || setPasswordForm.invalid"
          class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-sky-600 hover:bg-sky-700 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          @if (!loading) { <span>Guardar Contraseña</span> } @else { <span>Guardando...</span> }
        </button>
      </div>
    </form>
  </div>
</div>