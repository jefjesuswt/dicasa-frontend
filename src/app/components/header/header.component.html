<header class="bg-white shadow-md sticky top-0 z-50">
  <nav class="w-full px-4 py-4">
    <div class="flex items-center w-full">
      <a routerLink="/" class="text-2xl font-bold text-sky-600 flex-shrink-0">
        Dicasa Group
      </a>
      
      <div class="flex-grow"></div>
      
      <div class="hidden md:flex items-center space-x-6">
        
        @for (link of navLinks; track link.path) {
          <a 
            [routerLink]="link.path" 
            routerLinkActive="text-sky-600 font-medium" 
            [routerLinkActiveOptions]="{exact: link.exact}"
            class="text-gray-700 hover:text-sky-600 transition-colors whitespace-nowrap"
          >
            {{ link.label }}
          </a>
        }

        @if (user()) {
          <div class="relative ml-4">
            
            <button (click)="toggleProfileMenu()" type="button" class="flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-full transition-colors">
              <i class="pi pi-user"></i>
              <span class="font-medium text-sm">{{ user()?.name }}</span>
              <i class="pi pi-chevron-down text-xs transition-transform" [class.rotate-180]="isProfileMenuOpen"></i>
            </button>

            @if (isProfileMenuOpen) {
              <div class="absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50">
                <div class="py-1" role="menu" aria-orientation="vertical">
                  
                  <div class="px-4 py-3 border-b border-gray-200">
                    <p class="text-sm font-medium text-gray-900 truncate">{{ user()?.name }}</p>
                    <p class="text-sm text-gray-500 truncate">{{ user()?.email }}</p>
                  </div>
                  
                  <div class="py-1">
                    @if (isPrivilegedUser()) {
                      <a routerLink="/dashboard" (click)="isProfileMenuOpen = false" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
                        <i class="pi pi-cog mr-2"></i> Dashboard
                      </a>
                    }
                    <a routerLink="/profile" (click)="isProfileMenuOpen = false" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
                      <i class="pi pi-user-edit mr-2"></i> Mi Perfil
                    </a>
                    <a routerLink="/properties/new" (click)="isProfileMenuOpen = false" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">
                      <i class="pi pi-megaphone mr-2"></i> Publica
                    </a>
                  </div>
                  
                  <div class="py-1 border-t border-gray-200">
                    <button (click)="logout()" class="flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100" role="menuitem">
                      <i class="pi pi-sign-out mr-2"></i> Cerrar Sesi贸n
                    </button>
                  </div>
                </div>
              </div>
            }
          </div>

        } @else {
          <a routerLink="/auth/login" class="text-gray-700 hover:text-sky-600 transition-colors whitespace-nowrap">
            Iniciar Sesi贸n
          </a>
          <a routerLink="/auth/register" class="bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 transition-colors ml-4">
            Publica con Nosotros
          </a>
        }
      </div>
      
      <button 
        (click)="toggleMobileMenu()" 
        class="md:hidden text-gray-700 hover:text-sky-600 focus:outline-none ml-4"
        aria-label="Toggle menu"
      >
        @if (!isMenuOpen) {
          <i class="pi pi-bars text-2xl"></i>
        } @else {
          <i class="pi pi-times text-2xl"></i>
        }
      </button>
    </div>
    
    @if (isMenuOpen) {
      <div class="md:hidden mt-4 pb-2">
        <div class="flex flex-col space-y-3">
          
          @for (link of navLinks; track link.path) {
            <a 
              [routerLink]="link.path"
              (click)="isMenuOpen = false"
              routerLinkActive="text-sky-600 font-medium"
              [routerLinkActiveOptions]="{exact: link.exact}"
              class="flex items-center py-2 px-4 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"
            >
              <i class="pi pi-{{ getIconForRoute(link.path) }} mr-2"></i>
              {{ link.label }}
            </a>
          }

          @if (!user()) {
            <a 
              routerLink="/auth/login"
              (click)="isMenuOpen = false"
              routerLinkActive="text-sky-600 font-medium"
              class="flex items-center py-2 px-4 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"
            >
              <i class="pi pi-{{ getIconForRoute('/auth/login') }} mr-2"></i>
              Iniciar sesi贸n
            </a>
          } @else {
            @if (isPrivilegedUser()) {
              <a routerLink="/dashboard" (click)="isMenuOpen = false" class="flex items-center py-2 px-4 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
                <i class="pi pi-cog mr-2"></i> Dashboard
              </a>
            }
            <a routerLink="/profile" (click)="isMenuOpen = false" class="flex items-center py-2 px-4 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
              <i class="pi pi-user-edit mr-2"></i> Mi Perfil
            </a>
            <a (click)="logout()" class="flex items-center py-2 px-4 text-red-600 hover:bg-gray-100 rounded-lg transition-colors cursor-pointer">
              <i class="pi pi-{{ getIconForRoute('logout') }} mr-2"></i>
              Cerrar sesi贸n
            </a>
          }
          
          <button class="w-full bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 transition-colors mt-2 flex items-center justify-center">
            <i class="pi pi-megaphone mr-2"></i>
            Publica con Nosotros
          </button>
        </div>
      </div>
    }
  </nav>
</header>