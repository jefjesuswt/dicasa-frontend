@import "tailwindcss";

@import 'leaflet/dist/leaflet.css';
@import 'leaflet-control-geocoder/dist/Control.Geocoder.css';

/* Fix para que los controles se vean bien en modo oscuro */
.leaflet-control-geocoder-form input {
  color: #000 !important;
  /* Texto negro en el buscador */
}

/* --- LEAFLET DARK MODE FIXES --- */
/* Customize Geocoder for dark mode integration if needed, but the white BG is usually safest */
.leaflet-control-geocoder {
  border: 1px solid var(--border-light) !important;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
}

/**
 * Tailwind CSS v4 Modern Plugins
 * NOTE: The @plugin rule is a modern Tailwind v4 feature. 
 * If your IDE shows a warning, it's likely due to outdated linting rules. 
 */
@plugin "@tailwindcss/typography";

/* Oculta la scrollbar en Firefox y IE/Edge (versiones antiguas) */
html {
  scrollbar-width: none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE y Edge */
  -ms-overflow-style: none;
  /* IE y Edge */
}

.no-scrollbar::-webkit-scrollbar {
  display: none;
}

.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Transición Global de Tema */
body,
header,
footer,
section,
div,
button,
a,
h1,
h2,
h3,
h4,
h5,
h6,
p,
span,
i {
  /* Include filter and transform for synchronized logo/icon transitions */
  transition-property: background-color, border-color, color, fill, stroke,
    filter, transform, opacity, box-shadow;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 200ms;
}

/* Animación de slide down para filtros colapsables */
.animate-slide-down {
  animation: slideDown 0.3s ease-out forwards;
}

@keyframes slideDown {
  from {
    opacity: 0;
    max-height: 0;
    transform: translateY(-10px);
  }

  to {
    opacity: 1;
    max-height: 500px;
    transform: translateY(0);
  }
}

/* Variables Globales del Tema Dicasa "Architectural" */

/* Light Mode Variables (Default) */
:root {
  --color-primary: theme("colors.sky.400");
  --color-primary-hover: theme("colors.sky.500");
  --color-secondary: theme("colors.blue.800");
  --bg-dark: theme("colors.sky.100");
  --bg-panel: rgb(56 189 248 / 0.05);
  /* sky-400 @ 5% */
  --bg-section-alt: theme("colors.sky.100");
  --border-light: rgb(0 0 0 / 0.1);
  --text-primary: theme("colors.gray.900");
  --text-secondary: theme("colors.gray.800");
  --text-heading: theme("colors.black");
  --btn-primary-bg: theme("colors.gray.900");
  --btn-primary-text: theme("colors.white");
  --btn-secondary-bg: transparent;
  --btn-secondary-text: theme("colors.gray.800");
  --btn-secondary-border: rgb(31 41 55 / 0.2);
  /* gray-600 @ 30% */

  /* Tooltip Specifics */
  --tooltip-bg: #ffffff;
  --tooltip-border: theme("colors.slate.200");
  --tooltip-text: theme("colors.slate.700");
  --tooltip-text-secondary: theme("colors.slate.500");
  --tooltip-hover-bg: theme("colors.slate.50");

  /* Calendar Specifics */
  --calendar-text: theme("colors.slate.950");
  --calendar-bg-current: theme("colors.slate.50");
  --calendar-bg-dim: #ffffff;
}

/* Dark Mode Variables */
:root.dark {
  --color-primary: theme("colors.sky.400");
  --color-primary-hover: theme("colors.sky.500");
  --color-secondary: theme("colors.blue.800");
  --bg-dark: theme("colors.slate.950");
  --bg-panel: rgb(255 255 255 / 0.03);
  /* white @ 3% */
  --bg-section-alt: rgb(255 255 255 / 0.02);
  /* white @ 2% */
  --border-light: rgb(255 255 255 / 0.1);
  /* white @ 10% */
  --text-primary: theme("colors.slate.100");
  --text-secondary: theme("colors.slate.300");
  --text-heading: theme("colors.white");
  --btn-primary-bg: theme("colors.white");
  --btn-primary-text: theme("colors.slate.950");
  --btn-secondary-bg: transparent;
  --btn-secondary-text: theme("colors.white");
  --btn-secondary-border: rgb(255 255 255 / 0.2);
  /* white @ 20% */

  /* Tooltip Specifics */
  --tooltip-bg: #0f172a;
  /* slate-900 */
  --tooltip-border: theme("colors.slate.700");
  --tooltip-text: theme("colors.slate.100");
  --tooltip-text-secondary: theme("colors.slate.400");
  --tooltip-hover-bg: theme("colors.slate.800");

  /* Calendar Specifics */
  --calendar-text: #ffffff;
  --calendar-bg-current: theme("colors.slate.800");
  --calendar-bg-dim: theme("colors.slate.900");
}

/* --- 2. UTILIDADES DE DISEÑO --- */

/* Fondo de Rejilla (Grid) Arquitectónico */
.bg-grid {
  background-size: 40px 40px;
  background-image: none;
}

.dark .bg-grid {
  /* background-image: linear-gradient(to right,
      var(--border-light) 1px,
      transparent 1px),
    linear-gradient(to bottom, var(--border-light) 1px, transparent 1px); */
  background-image: none;
}

/* Texto con Gradiente Corporativo */
.text-gradient {
  background: linear-gradient(to right, var(--color-primary), #2563eb);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  color: transparent;
}

/* Panel de Vidrio (Glassmorphism) */
.glass-panel {
  background: var(--bg-panel);
  border: 1px solid var(--border-light);
  backdrop-filter: blur(8px);
}

/* Calendar Solid Grid */
.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, minmax(0, 1fr));
  background-color: var(--tooltip-bg);
  border: 1px solid var(--tooltip-border);
  border-radius: 0.5rem;
  overflow: hidden;
  /* Ensures borders don't leak */
}

.calendar-cell {
  border-right: 1px solid var(--tooltip-border);
  border-bottom: 1px solid var(--tooltip-border);
}

.calendar-cell:nth-child(7n) {
  border-right: none;
}

/* Logic implies we have headers (7) + days (variable).
   To handle border-bottom correctly for dynamic grid is tricky with nth-last-child
   if total count varies.
   Instead, we can just let internal borders be and outer border handle the edge.
   Actually, standard way is: border-right and border-bottom on ALL cells,
   then remove right on 7n, and bottom on last row.
   But last row is hard to target dynamically in CSS Grid without subgrid or js.
   Simpler: Use gap-px with a SOLID background color for the container
   that matches the border color, and solid background for cells.
   The User explicitly hated the 'gap-px' trick?
   "quiero que el calendario sea un calendario cuadrado, con bordes bien definidos"
   The gap-px IS the best way to get perfect 1px borders.
   Maybe the previous colors were just too subtle (glassy).
   Let's try gap-px again but with HIGH CONTRAST colors.
   Container BG = Border Color (e.g., slate-200 / slate-800).
   Cell BG = Solid Cell Color (white / slate-950).
   This creates perfect borders.
*/
.calendar-solid-container {
  background-color: var(--tooltip-border);
  border: 1px solid var(--tooltip-border);
  gap: 1px;
}

.calendar-solid-cell {
  background-color: var(--tooltip-bg);
}

/* --- 3. ANIMACIONES E INTERACCIONES --- */

/* Efecto de línea inferior en Hover (Navbar) */
.hover-line {
  position: relative;
}

.hover-line::after {
  content: "";
  position: absolute;
  bottom: -4px;
  left: 0;
  width: 0%;
  height: 1px;
  background-color: var(--color-primary);
  transition: width 0.3s ease;
}

.hover-line:hover::after {
  width: 100%;
}

/* Lógica Reveal on Scroll (Scroll Spy) */
.reveal-on-scroll {
  opacity: 0;
  transform: translateY(30px);
  transition: all 0.8s cubic-bezier(0.2, 1, 0.3, 1);
  will-change: opacity, transform;
}

.reveal-on-scroll.is-visible {
  opacity: 1;
  transform: translateY(0);
}

/* Comportamiento Específico por Dispositivo */

/* MOBILE: Al entrar en pantalla, quitamos gris y mostramos todo */
@media (max-width: 768px) {
  .reveal-on-scroll.is-visible .scroll-target-grayscale {
    filter: grayscale(0) !important;
  }

  .reveal-on-scroll.is-visible .scroll-target-opacity {
    opacity: 1 !important;
  }

  .reveal-on-scroll.is-visible .scroll-target-border {
    opacity: 1 !important;
  }
}

/* DESKTOP: Solo mostramos opacidad, mantenemos gris para que funcione el hover */
@media (min-width: 769px) {
  .reveal-on-scroll.is-visible .scroll-target-opacity {
    opacity: 1 !important;
  }

  /* No forzamos grayscale(0) aquí para permitir que el hover CSS funcione */
}

.iti {
  width: 100%;
  display: block;
  position: relative;
}

/* INPUT PRINCIPAL */
.iti__tel-input {
  appearance: none;
  position: relative;
  display: block;
  width: 100%;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;

  /* Fondo transparente y sin bordes */
  background-color: transparent !important;
  border: none !important;
  box-shadow: none !important;

  /* Texto Blanco */
  color: #ffffff !important;

  font-size: 1rem;
  line-height: 1.5rem;

  /* --- CORRECCIÓN AQUÍ --- */
  /* Aumentamos de 3rem a 6rem para que el texto no se monte sobre el +58 */
  padding-left: 5rem !important;

  /* Placeholder más claro */
  --placeholder-color: #64748b;
  /* slate-500 */
}

/* Placeholder específico */
.iti__tel-input::placeholder {
  color: var(--placeholder-color) !important;
  opacity: 1;
  font-size: 0.875rem;
}

/* Focus: Quitamos el outline azul por defecto porque usamos border-b en el HTML */
.iti__tel-input:focus {
  outline: none !important;
  box-shadow: none !important;
  border-color: transparent !important;
}

/* --- DROPDOWN (LISTA DE PAÍSES) --- */
.iti__country-list {
  position: absolute !important;
  z-index: 9999 !important;
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5),
    0 4px 6px -2px rgba(0, 0, 0, 0.3);

  box-sizing: border-box;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  /* Borde fino blanco */
  border-radius: 0.25rem;
  margin-top: 0.5rem;

  max-height: 18rem;
  overflow-y: auto;

  /* --- CAMBIO CRÍTICO: Fondo Oscuro --- */
  background-color: #020617 !important;
  /* slate-950 */
  backdrop-filter: blur(10px);

  scrollbar-width: thin;
  scrollbar-color: #334155 #020617;
}

/* Ocultar buscador nativo feo */
.iti__search-container {
  display: none !important;
}

/* Bandera seleccionada */
.iti__selected-flag {
  background-color: transparent !important;
  outline: none !important;
  padding-left: 0 !important;
}

.iti__arrow {
  border-top-color: #94a3b8 !important;
  /* Flecha gris clara */
}

.iti__arrow.iti__arrow--up {
  border-bottom-color: #38bdf8 !important;
  /* Flecha azul al abrir */
}

/* Items de la lista (Países) */
.iti__country {
  display: flex !important;
  align-items: center !important;
  padding: 0.75rem 1rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  color: #e2e8f0 !important;
  /* Texto claro (slate-200) */
  font-size: 0.875rem;
  transition: all 0.2s;
}

/* Hover en los países */
.iti__country:hover,
.iti__country.iti__highlight {
  background-color: rgba(56, 189, 248, 0.1) !important;
  /* Azul transparente */
  color: #38bdf8 !important;
  /* Texto azul */
}

/* Código de país (+58, +1) */
.iti__dial-code {
  margin-left: auto;
  color: #64748b !important;
  /* slate-500 */
}

/* Scrollbar del dropdown */
.iti__country-list::-webkit-scrollbar {
  width: 6px;
}

.iti__country-list::-webkit-scrollbar-track {
  background: #020617;
}

.iti__country-list::-webkit-scrollbar-thumb {
  background-color: #334155;
  border-radius: 3px;
}

/* Autofill Fix para Chrome (Evita el fondo blanco forzado) */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active {
  -webkit-box-shadow: 0 0 0 30px var(--bg-dark) inset !important;
  -webkit-text-fill-color: var(--text-heading) !important;
  caret-color: var(--text-heading) !important;
  transition: background-color 5000s ease-in-out 0s;
}

/* --- PRIMENG OVERRIDES --- */

/* ToggleSwitch */
.p-toggleswitch .p-toggleswitch-slider {
  background-color: theme("colors.slate.200") !important;
  border: 1px solid theme("colors.slate.300") !important;
}

.dark .p-toggleswitch .p-toggleswitch-slider {
  background-color: theme("colors.slate.800") !important;
  border: 1px solid theme("colors.slate.700") !important;
}

.p-toggleswitch.p-toggleswitch-checked .p-toggleswitch-slider {
  background-color: var(--color-primary) !important;
  border-color: var(--color-primary-hover) !important;
}

.p-toggleswitch .p-toggleswitch-slider:before {
  background-color: #ffffff !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.dark .p-toggleswitch:not(.p-toggleswitch-checked) .p-toggleswitch-slider:before {
  background-color: theme("colors.slate.400") !important;
}

.p-toggleswitch:not(.p-toggleswitch-checked):hover .p-toggleswitch-slider {
  background-color: theme("colors.slate.300") !important;
}

.dark .p-toggleswitch:not(.p-toggleswitch-checked):hover .p-toggleswitch-slider {
  background-color: theme("colors.slate.700") !important;
}

/* --- ANIMACIONES ADICIONALES --- */
@keyframes loading-bar {
  0% {
    transform: translateX(-100%) scaleX(0.2);
  }

  50% {
    transform: translateX(0%) scaleX(0.5);
  }

  100% {
    transform: translateX(100%) scaleX(0.2);
  }
}

/* Ajuste visual para que el mapa ocupe el contenedor */
mgl-map {
  width: 100%;
  height: 100%;
}

/* --- MAPBOX GEOCODER EXTERNAL FIXES --- */
/* Target the geocoder when inside our custom container */
.geocoder-container .mapboxgl-ctrl-geocoder {
  min-width: 0 !important;
  width: 100% !important;
  max-width: 100% !important;
  box-shadow: none !important;
  border: 1px solid var(--border-light) !important;
  border-radius: 2px !important;
  background-color: var(--bg-dark) !important;
  margin: 0 !important;
}

/* Input styling to match form */
.geocoder-container .mapboxgl-ctrl-geocoder--input {
  color: var(--text-primary) !important;
  padding-left: 35px !important;
  /* Space for icon */
  height: 45px !important;
}

/* Icon styling */
.geocoder-container .mapboxgl-ctrl-geocoder--icon-search {
  fill: var(--text-secondary) !important;
  top: 12px !important;
  left: 10px !important;
}

/* Clear button */
.geocoder-container .mapboxgl-ctrl-geocoder--button {
  background-color: transparent !important;
}

.geocoder-container .mapboxgl-ctrl-geocoder--icon-close {
  fill: var(--text-secondary) !important;
}

/* Ensure suggestions overlay correctly */
.mapboxgl-ctrl-geocoder .suggestions {
  max-height: 250px !important;
  overflow-y: auto !important;
  background-color: #fff;
  border: 1px solid var(--border-light);
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  z-index: 1000;
  border-radius: 4px;
  margin-top: 4px;
}